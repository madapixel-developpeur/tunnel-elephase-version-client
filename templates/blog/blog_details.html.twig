{% extends 'base.html.twig' %}

{% block title %}Blog{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .img_blog_detail_user_anonymous{
            object-fit: cover;
            height: 530px;
            width: 100%;
        }
    </style>
{% endblock %}

{% block body %}
   
    <!--breadcrumbs area start-->
    <div class="breadcrumbs_area">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="breadcrumb_content">
                        <ul>
                            <li><a href="#">Accueil</a></li>
                            <li><a href="{{ path('app_blog_index') }}">Blog</a></li>
                            <li>Détails</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--breadcrumbs area end-->

    <!--blog area start-->
    <div class="blog_page_section mb-60">
        <div class="container">
            <div class="row">
                <div class="col-lg-9 col-md-12">
                    <!--blog grid area start-->
                    <div class="blog_wrapper blog_wrapper_details">
                        <article class="single_blog">
                            <figure>
                                <div class="post_header p-3">
                                    <h3 class="post_title">{{blog.titre}}</h3>
                                    <div class="blog_meta">
                                        <p>Publié par : <a href="#">{{blog.nomAuteur}}</a> / Le : <a href="#">{{blog.datePublication | date("j F Y, G:i ") }}</a> / Dans
                                            : <a href="#">{{blog.categorie.nom}}</a></p>
                                    </div>
                                </div>
                                {% if blog.image %}
                                <div class="blog_d_thumb">
                                    <img class="img_blog_detail_user_anonymous" src="{{ asset( files_directory_relative ~ blog.image) }}" alt="">
                                </div>
                                {% endif %}
                                <figcaption class="blog_content">
                                    <div class="post_content">
                                        {{blog.contenu | raw}}
                                    </div>
                                    <div class="entry_content">
                                        {% if blog.tags %}
                                        <div class="post_meta">
                                            <span>Tags: </span>
                                            {% for bt in blog.tags %}
                                            <span><a href="#">, {{bt.tag.nom}}</a></span>
                                            {% endfor %}
                                            
                                        </div>
                                        {% endif %}

                                        {# <div class="social_sharing">
                                            <p>share this post:</p>
                                            <ul>
                                                <li><a href="#" title="facebook"><i class="fa fa-facebook"></i></a></li>
                                                <li><a href="#" title="twitter"><i class="fa fa-twitter"></i></a></li>
                                                <li><a href="#" title="pinterest"><i class="fa fa-pinterest"></i></a>
                                                </li>
                                                <li><a href="#" title="google+"><i class="fa fa-google-plus"></i></a>
                                                </li>
                                                <li><a href="#" title="linkedin"><i class="fa fa-linkedin"></i></a></li>
                                            </ul>
                                        </div> #}
                                    </div>
                                </figcaption>
                            </figure>
                        </article>
                        {# <div class="related_posts">
                            <h3>Related posts</h3>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-6">
                                    <article class="single_related">
                                        <figure>
                                            <div class="related_thumb">
                                                <a href="blog-details.html"><img src="{{asset('bonique/assets/img/blog/blog1.jpg')}}"
                                                        alt=""></a>
                                            </div>
                                            <figcaption class="related_content">
                                                <h4><a href="#">Post with Gallery</a></h4>
                                                <div class="blog_meta">
                                                    <span class="author">By : <a href="#">admin</a> / </span>
                                                    <span class="meta_date"> April 11, 2019 </span>
                                                </div>
                                            </figcaption>
                                        </figure>
                                    </article>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-6">
                                    <article class="single_related">
                                        <figure>
                                            <div class="related_thumb">
                                                <a href="blog-details.html"><img src="{{asset('bonique/assets/img/blog/blog2.jpg')}}"
                                                        alt=""></a>
                                            </div>
                                            <figcaption class="related_content">
                                                <h4><a href="#">Post with Audio</a></h4>
                                                <div class="blog_meta">
                                                    <span class="author">By : <a href="#">admin</a> / </span>
                                                    <span class="meta_date"> April 11, 2019 </span>
                                                </div>
                                            </figcaption>
                                        </figure>
                                    </article>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-6">
                                    <article class="single_related">
                                        <figure>
                                            <div class="related_thumb">
                                                <a href="blog-details.html"><img src="{{asset('bonique/assets/img/blog/blog3.jpg')}}"
                                                        alt=""></a>
                                            </div>
                                            <figcaption class="related_content">
                                                <h4><a href="#">Maecenas ultricies</a></h4>
                                                <div class="blog_meta">
                                                    <span class="author">By : <a href="#">admin</a> / </span>
                                                    <span class="meta_date"> April 11, 2019 </span>
                                                </div>
                                            </figcaption>
                                        </figure>
                                    </article>
                                </div>
                            </div>
                        </div>
                        <div class="comments_box">
                            <h3>3 Comments </h3>
                            <div class="comment_list">
                                <div class="comment_thumb">
                                    <img src="{{asset('bonique/assets/img/blog/comment3.png.jpg')}}" alt="">
                                </div>
                                <div class="comment_content">
                                    <div class="comment_meta">
                                        <h5><a href="#">Admin</a></h5>
                                        <span>October 16, 2018 at 1:38 am</span>
                                    </div>
                                    <p>But I must explain to you how all this mistaken idea of denouncing pleasure</p>
                                    <div class="comment_reply">
                                        <a href="#">Reply</a>
                                    </div>
                                </div>

                            </div>
                            <div class="comment_list list_two">
                                <div class="comment_thumb">
                                    <img src="{{asset('bonique/assets/img/blog/comment3.png.jpg')}}" alt="">
                                </div>
                                <div class="comment_content">
                                    <div class="comment_meta">
                                        <h5><a href="#">Demo</a></h5>
                                        <span>October 16, 2018 at 1:38 am</span>
                                    </div>
                                    <p>Quisque semper nunc vitae erat pellentesque, ac placerat arcu consectetur</p>
                                    <div class="comment_reply">
                                        <a href="#">Reply</a>
                                    </div>
                                </div>
                            </div>
                            <div class="comment_list">
                                <div class="comment_thumb">
                                    <img src="{{asset('bonique/assets/img/blog/comment3.png.jpg')}}" alt="">
                                </div>
                                <div class="comment_content">
                                    <div class="comment_meta">
                                        <h5><a href="#">Admin</a></h5>
                                        <span>October 16, 2018 at 1:38 am</span>
                                    </div>
                                    <p>Quisque orci nibh, porta vitae sagittis sit amet, vehicula vel mauris. Aenean at
                                    </p>
                                    <div class="comment_reply">
                                        <a href="#">Reply</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="comments_form">
                            <h3>Leave a Reply </h3>
                            <p>Your email address will not be published. Required fields are marked *</p>
                            <form action="#">
                                <div class="row">
                                    <div class="col-12">
                                        <label for="review_comment">Comment </label>
                                        <textarea name="comment" id="review_comment"></textarea>
                                    </div>
                                    <div class="col-lg-4 col-md-4">
                                        <label for="author">Name</label>
                                        <input id="author" type="text">

                                    </div>
                                    <div class="col-lg-4 col-md-4">
                                        <label for="email">Email </label>
                                        <input id="email" type="text">
                                    </div>
                                    <div class="col-lg-4 col-md-4">
                                        <label for="website">Website </label>
                                        <input id="website" type="text">
                                    </div>
                                </div>
                                <button class="button" type="submit">Post Comment</button>
                            </form>
                        </div> #}
                    </div>
                    <!--blog grid area start-->
                </div>
                <div class="col-lg-3 col-md-12 mt-4">
                {{ form_start(form, {'attr': {'class': 'my-form'}, 'action': path('app_blog_index')}) }}
                    <div class="blog_sidebar_widget">
                        <div class="widget_list widget_search">
                            <div class="widget_title">
                                <h3>Recherche</h3>
                            </div>
                            {{form_widget(form.search, {'attr': {'placeholder': 'Recherche...'}})}}
                            <button type="submit">Rechercher</button>
                        </div>
                        <div class="d-none" >
                            {{form_widget(form.categorie)}}
                            {{form_widget(form.tags)}}
                        </div>
                        {# <div class="widget_list comments">
                            <div class="widget_title">
                                <h3>Recent Comments</h3>
                            </div>
                            <div class="post_wrapper">
                                <div class="post_thumb">
                                    <a href="blog-details.html"><img src="{{ asset('bonique/assets/img/blog/comment2.png.jpg')}}" alt=""></a>
                                </div>
                                <div class="post_info">
                                    <span> <a href="#">demo</a> says:</span>
                                    <a href="blog-details.html">Quisque semper nunc</a>
                                </div>
                            </div>
                            <div class="post_wrapper">
                                <div class="post_thumb">
                                    <a href="blog-details.html"><img src="{{ asset('bonique/assets/img/blog/comment2.png.jpg')}}" alt=""></a>
                                </div>
                                <div class="post_info">
                                    <span><a href="#">admin</a> says:</span>
                                    <a href="blog-details.html">Quisque orci porta...</a>
                                </div>
                            </div>
                            <div class="post_wrapper">
                                <div class="post_thumb">
                                    <a href="blog-details.html"><img src="{{ asset('bonique/assets/img/blog/comment2.png.jpg')}}" alt=""></a>
                                </div>
                                <div class="post_info">
                                    <span><a href="#">demo</a> says:</span>
                                    <a href="blog-details.html">Quisque semper nunc</a>
                                </div>
                            </div>
                        </div> #}
                        <div class="widget_list widget_post">
                            <div class="widget_title">
                                <h3>Articles récents</h3>
                            </div>
                            {% for blog in recentBlog %}
                            <div class="post_wrapper">
                                <div class="post_thumb">
                                    <a href="blog-details.html"><img src="{{ asset( files_directory_relative ~ blog.image) }}" alt=""></a>
                                </div>
                                <div class="post_info">
                                    <h4><a href="blog-details.html">{{blog.titre}}</a></h4>
                                    <span>{{blog.datePublication | date("j F Y, G:i ") }}</span>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        <div class="widget_list widget_categories">
                            <div class="widget_title">
                                <h3>Catégories</h3>
                            </div>
                            <ul class="category_widget" id="categories-selection">
                                {% for choice in form.categorie.vars.choices %}
                                <li>
                                    <div class="category_item" data-choice-value="{{choice.value}}">{{choice.label}}</div>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="widget_list widget_tag">
                            <div class="widget_title">
                                <h3>Tags</h3>
                            </div>
                            <div class="tag_widget">
                                <ul id="tags-selection">
                                    {% for choice in form.tags.vars.choices %}
                                    <li data-choice-value="{{choice.value}}">{{choice.label}}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                {{ form_end(form) }}    
                </div>
            </div>
        </div>
    </div>
    <!--blog area end-->

{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        window.onload = () => {
            let tags = $('#tags-selection li');
            let categories = $('#categories-selection .category_item');
            let categorieSelect = $('#blog_filter_client_categorie');

            function getTagInput(tag){
                let value = $(tag).attr('data-choice-value');
                let input = $('#blog_filter_client_tags input[value="'+value+'"]');
                return input;
            }

            function checkCategorie(){
                let value = categorieSelect.val();
                categories.each(function (index){
                    let itemValue = $(this).attr('data-choice-value');
                    if(itemValue == value){
                        $(this).addClass('selected');
                    } else{
                        $(this).removeClass('selected');
                    }
                });
            }

            tags.click(function (){
                let input = getTagInput(this);
                let checked = input.attr('checked') ?? false;
                checked = !checked;
                input.attr('checked', checked);
                if(checked){
                    $(this).addClass('selected');
                } else{
                    $(this).removeClass('selected');
                }
            });

            categories.click(function (){
                let valueBefore = categorieSelect.val();
                let value = $(this).attr('data-choice-value');
                value = value == valueBefore ? '' : value;
                categorieSelect.val(value);
                checkCategorie();
            });


            tags.each(function (index){
                let input = getTagInput(this);
                let checked = input.attr('checked') ?? false;
                if(checked){
                    $(this).addClass('selected');
                } else{
                    $(this).removeClass('selected');
                }
            });
            checkCategorie();
            // Hide loader
            document.getElementById("loading_aroma").classList.add('hide');
        };
        
    </script>
{% endblock %}
