{% extends "base.html.twig" %}

{% block title %}
    Commande
{% endblock %}

{% block stylesheets %}
    {{ parent() }}

{% endblock %}

{% block body %}
<div class="kleanity-page-title-wrap  kleanity-style-medium kleanity-left-align"><div class="kleanity-header-transparent-substitute" style="height: 0px;"></div><div class="kleanity-page-title-overlay"></div><div class="kleanity-page-title-container kleanity-container"><div class="kleanity-page-title-content kleanity-item-pdlr"><h1 class="kleanity-page-title">Commande</h1></div></div></div>
<div class="kleanity-page-wrapper my-font-regular" id="kleanity-page-wrapper">
    <div class="gdlr-core-page-builder-body">
        {# <div class="gdlr-core-pbf-wrapper " style="margin: 100px 0px 0px 0px;padding: 200px 0px 150px 0px;" data-skin="Dark">
            <div class="gdlr-core-pbf-background-wrap">
                <div class="gdlr-core-pbf-background gdlr-core-parallax gdlr-core-js" style="background-image: url(upload/about-team-bg.jpg);background-size: cover;background-position: center;" data-parallax-speed="0.3"></div>
            </div>
            <div class="gdlr-core-pbf-wrapper-content gdlr-core-js " data-gdlr-animation="fadeIn" data-gdlr-animation-duration="600ms" data-gdlr-animation-offset="0.8">
                <div class="gdlr-core-pbf-wrapper-container clearfix gdlr-core-container">
                    <div class="gdlr-core-pbf-element">
                        <div class="gdlr-core-title-item gdlr-core-item-pdb clearfix  gdlr-core-left-align gdlr-core-title-item-caption-bottom gdlr-core-item-pdlr">
                            <div class="gdlr-core-title-item-title-wrap ">
                                <h3 class="gdlr-core-title-item-title gdlr-core-skin-title " style="font-size: 75px;">Contact Us<span class="gdlr-core-title-item-title-divider gdlr-core-skin-divider"></span></h3>
                            </div><span class="gdlr-core-title-item-caption gdlr-core-info-font gdlr-core-skin-caption" style="font-size: 25px;margin-top: 15px;">Get Intouch</span></div>
                    </div>
                </div>
            </div>
        </div> #}
        
        <div class="gdlr-core-pbf-wrapper " style="padding: 60px 0px 100px 0px;">
            <div class="gdlr-core-pbf-background-wrap" style="background-color: #f5f5f5 ;"></div>
            <div class="gdlr-core-pbf-wrapper-content gdlr-core-js ">
                <div class="gdlr-core-pbf-wrapper-container clearfix gdlr-core-container ">
                    {{form_start(form, {attr: {id: 'form-payment'}})}}
                    {% for label, messages in app.flashes %}
                        {% for message in messages %}
                            <div class="alert alert-{{label}}">{{ message | raw }}</div>
                        {% endfor %}
                    {% endfor %}
                    <div class="gdlr-core-pbf-column gdlr-core-column-30 gdlr-core-column-first">
                        <div class="gdlr-core-pbf-column-content-margin gdlr-core-js " style="padding: 50px 20px 0px 20px;">
                            <div class="gdlr-core-pbf-column-content clearfix gdlr-core-js ">
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-title-item gdlr-core-item-pdb clearfix  gdlr-core-left-align gdlr-core-title-item-caption-bottom gdlr-core-item-pdlr" style="padding-bottom: 15px;">
                                        <div class="gdlr-core-title-item-title-wrap ">
                                            <h3 class="gdlr-core-title-item-title gdlr-core-skin-title my-font-regular" style="font-size: 32px;letter-spacing: 0px;text-transform: none;">Vos informations <span class="gdlr-core-title-item-title-divider gdlr-core-skin-divider"></span></h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-divider-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-divider-item-normal">
                                        <div class="gdlr-core-divider-container gdlr-core-left-align" style="max-width: 40px;">
                                            <div class="gdlr-core-divider-line gdlr-core-skin-divider" style="border-color: #3a3a3a;border-bottom-width: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-text-box-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-left-align" style="padding-bottom: 25px;">
                                        <div class="gdlr-core-text-box-item-content" style="font-size: 16px;">
                                            {# <p>A wonderful serenity has taken possession of my entire soul, like these sweet mornings of spring which I enjoy with my whole heart. I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p> #}
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-contact-form-7-item gdlr-core-item-pdlr gdlr-core-item-pdb ">
                                        <div role="form" class="wpcf7" id="wpcf7-f1979-p1977-o1" lang="en-US" dir="ltr">
                                            <div class="screen-reader-response"></div>
                                            
                                            {# <form class="quform" action="quform/process.php" method="post" enctype="multipart/form-data" onclick=""> #}

                                                <div class="quform-elements gdlr-core-input-wrap gdlr-core-large gdlr-core-full-width gdlr-core-with-column gdlr-core-no-border">
                                                    <div class="gdlr-core-column-30">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.prenom)}}
                                                            {{form_widget(form.info.prenom, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.prenom)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-30">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.nom)}}
                                                            {{form_widget(form.info.nom, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.nom)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.nomEntreprise)}}
                                                            {{form_widget(form.info.nomEntreprise, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.nomEntreprise)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.paysRegion)}}
                                                            {{form_widget(form.info.paysRegion, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.paysRegion)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.rue)}}
                                                            {{form_widget(form.info.rue, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.rue)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_widget(form.info.lot, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.lot)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.ville)}}
                                                            {{form_widget(form.info.ville, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.ville)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.provinceDepartement)}}
                                                            {{form_widget(form.info.provinceDepartement, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.provinceDepartement)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.telephone)}}
                                                            {{form_widget(form.info.telephone, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.telephone)}}
                                                        </span>
                                                    </div>
                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-name">
                                                            {{form_label(form.info.email)}}
                                                            {{form_widget(form.info.email, {attr: {class: 'wpcf7-form-control wpcf7-text my-font-regular'}})}}
                                                            {{form_errors(form.info.email)}}
                                                        </span>
                                                    </div>
                                                    
                                                    <div class="clear"></div>

                                                    <div class="gdlr-core-column-60">
                                                        <span class="quform-element wpcf7-form-control-wrap your-message">
                                                            {{form_label(form.info.notes)}}
                                                            {{form_widget(form.info.notes, {attr: {class: 'wpcf7-form-control wpcf7-textarea my-font-regular'}})}}
                                                            {{form_errors(form.info.notes)}}
                                                        </span>
                                                    </div> 
                                                    
                                                </div>
                                            {# </form> #}
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="gdlr-core-pbf-column gdlr-core-column-30">
                        <div class="gdlr-core-pbf-column-content-margin gdlr-core-js " style="padding: 50px 20px 0px 20px;">
                            <div class="gdlr-core-pbf-column-content clearfix gdlr-core-js ">
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-title-item gdlr-core-item-pdb clearfix  gdlr-core-left-align gdlr-core-title-item-caption-bottom gdlr-core-item-pdlr" style="padding-bottom: 15px;">
                                        <div class="gdlr-core-title-item-title-wrap ">
                                            <h3 class="gdlr-core-title-item-title gdlr-core-skin-title my-font-regular" style="font-size: 28px;letter-spacing: 0px;text-transform: none;">Votre commande<span class="gdlr-core-title-item-title-divider gdlr-core-skin-divider"></span></h3>
                                        </div>
                                    </div>
                                </div>
                                {# <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-divider-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-divider-item-normal">
                                        <div class="gdlr-core-divider-container gdlr-core-left-align" style="max-width: 40px;">
                                            <div class="gdlr-core-divider-line gdlr-core-skin-divider" style="border-color: #3a3a3a;border-bottom-width: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-text-box-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-left-align" style="padding-bottom: 0px;">
                                        <div class="gdlr-core-text-box-item-content" style="font-size: 16px;">
                                            <p>4 apt. Flawing Street. The Grand Avenue.<br>Liverpool, UK 33342</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-icon-list-item gdlr-core-item-pdlr gdlr-core-item-pdb ">
                                        <ul>
                                            <li class=" gdlr-core-skin-divider gdlr-core-with-hover"><span class="gdlr-core-icon-list-icon-wrap"><i class="gdlr-core-icon-list-icon-hover fa fa-envelope-o" style="font-size: 16px;width: 16px;"></i><i class="gdlr-core-icon-list-icon fa fa-envelope-o" style="font-size: 16px;width: 16px;"></i></span><span class="gdlr-core-icon-list-content" style="font-size: 16px;">contact@infinitewptheme.com</span></li>
                                            <li class=" gdlr-core-skin-divider gdlr-core-with-hover"><span class="gdlr-core-icon-list-icon-wrap"><i class="gdlr-core-icon-list-icon-hover fa fa-phone" style="font-size: 16px;width: 16px;"></i><i class="gdlr-core-icon-list-icon fa fa-phone" style="font-size: 16px;width: 16px;"></i></span><span class="gdlr-core-icon-list-content" style="font-size: 16px;">+1-3524-3356</span></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-title-item gdlr-core-item-pdb clearfix  gdlr-core-left-align gdlr-core-title-item-caption-bottom gdlr-core-item-pdlr" style="padding-bottom: 15px;">
                                        <div class="gdlr-core-title-item-title-wrap ">
                                            <h3 class="gdlr-core-title-item-title gdlr-core-skin-title " style="font-size: 28px;letter-spacing: 0px;text-transform: none;">Map<span class="gdlr-core-title-item-title-divider gdlr-core-skin-divider"></span></h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-divider-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-divider-item-normal">
                                        <div class="gdlr-core-divider-container gdlr-core-left-align" style="max-width: 40px;">
                                            <div class="gdlr-core-divider-line gdlr-core-skin-divider" style="border-color: #3a3a3a;border-bottom-width: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-wp-google-map-plugin-item gdlr-core-item-pdlr gdlr-core-item-pdb " style="padding-bottom: 0px;">
                                        <div class="wpgmp_map_container wpgmp-map-2" rel="map2">
                                            <div class="wpgmp_map " style="width:100%; height:250px;" id="map2"></div>
                                        </div>

                                    </div>
                                </div> #}
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-divider-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-divider-item-normal">
                                        <div class="gdlr-core-divider-container gdlr-core-left-align" style="max-width: 40px;">
                                            <div class="gdlr-core-divider-line gdlr-core-skin-divider" style="border-color: #3a3a3a;border-bottom-width: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-text-box-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-left-align" style="padding-bottom: 25px;">
                                        <div class="gdlr-core-text-box-item-content" style="font-size: 16px;">
                                            {# <p>A wonderful serenity has taken possession of my entire soul, like these sweet mornings of spring which I enjoy with my whole heart. I am alone, and feel the charm of existence in this spot, which was created for the bliss of souls like mine.</p> #}
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-contact-form-7-item gdlr-core-item-pdlr gdlr-core-item-pdb ">
                                        <div role="form" class="wpcf7" id="wpcf7-f1979-p1977-o1" lang="en-US" dir="ltr">
                                            <div class="quform-elements gdlr-core-input-wrap gdlr-core-large gdlr-core-full-width gdlr-core-with-column gdlr-core-no-border">
                                                
                                                <div class="screen-reader-response"></div>
                                                <table class="table  my-font-regular" style="white-space: nowrap;">
                                                    <thead>
                                                        <tr>
                                                        <th >Produit</th>
                                                        <th >PU</th>
                                                        <th >Quantité</th>                                            
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                <div class="d-flex" style="height:4em !important;">
                                                                    <span class="m-auto">
                                                                         {{coffret.nom}}
                                                                    </span>

                                                                </div>
                                                            </td>
                                                            <td>
                                                                <div class="d-flex" style="height:4em !important;">
                                                                   <span class="m-auto">
                                                                       {{coffret.prix | format_currency(my_currency, {}, locale)}}
                                                                   </span>
                                                                </div>

                                                            </td>
                                                            <td class="d-flex">
                                                                <div class="gdlr-core-column-30 mx-auto d-flex" style="height:4em; margin-bottom:0px !important;">
                                                                    <span class="quform-element wpcf7-form-control-wrap your-name mx-auto">
                                                                        {{form_widget(form.qteCoffret, {attr: {class: 'wpcf7-form-control wpcf7-text text-center', onchange: 'refreshTotal(this)'}})}}
                                                                        {{form_errors(form.qteCoffret)}}
                                                                    </span>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        
                                                        <tr>
                                                        <td colspan="2" ><span style="font-weight: bold">Montant total</span></td>
                                                        <td id="total-amount">{{(coffret.prix * order.qteCoffret) | format_currency(my_currency, {}, locale)}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                {% if not payment %}
                                                <div class="gdlr-core-column-60">
                                                    <div class="quform-submit">
                                                        <div class="quform-submit-inner">
                                                            <button type="submit" class="submit-button my-font-regular"><span><em>Commander</em></span></button>
                                                        </div>
                                                        <div class="quform-loading-wrap"><span class="quform-loading"></span></div>
                                                    </div>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>          
                                </div>
                                {% if payment %}
                                <div class="gdlr-core-pbf-element" style="margin-top: 50px;">
                                    <div class="gdlr-core-title-item gdlr-core-item-pdb clearfix  gdlr-core-left-align gdlr-core-title-item-caption-bottom gdlr-core-item-pdlr" style="padding-bottom: 15px;">
                                        <div class="gdlr-core-title-item-title-wrap ">
                                            <h3 class="gdlr-core-title-item-title gdlr-core-skin-title my-font-regular" style="font-size: 28px;letter-spacing: 0px;text-transform: none;">Paiement<span class="gdlr-core-title-item-title-divider gdlr-core-skin-divider"></span></h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element">
                                    <div class="gdlr-core-divider-item gdlr-core-item-pdlr gdlr-core-item-pdb gdlr-core-divider-item-normal">
                                        <div class="gdlr-core-divider-container gdlr-core-left-align" style="max-width: 40px;">
                                            <div class="gdlr-core-divider-line gdlr-core-skin-divider" style="border-color: #3a3a3a;border-bottom-width: 2px;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="gdlr-core-pbf-element" style="margin-top: 20px;">
                                    <div class="gdlr-core-contact-form-7-item gdlr-core-item-pdlr gdlr-core-item-pdb ">
                                        <div role="form" class="wpcf7"  lang="en-US" dir="ltr">
                                            <div class="screen-reader-response"></div>
                                            {{form_widget(form.token)}}
                                            <div class="quform-elements gdlr-core-input-wrap gdlr-core-large gdlr-core-full-width gdlr-core-with-column gdlr-core-no-border">
                                                <div class="gdlr-core-column-60">
                                                    <span class="quform-element wpcf7-form-control-wrap your-name">
                                                        <label for="card-element my-font-regular">Carte de crédit</label>
                                                        <div id="card-element" class="form-control"></div>
                                                        <div id="card-errors" class="invalid-feedback d-block"></div>
                                                    </span>
                                                </div>
                                                <div class="gdlr-core-column-60">
                                                    <div class="quform-submit">
                                                        <div class="quform-submit-inner">
                                                            <button type="submit" id="btn-pay" class="submit-button"><span><em>Payer</em></span></button>
                                                        </div>
                                                        <div class="quform-loading-wrap"><span class="quform-loading"></span></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}

                        </div>
                    </div>
                    {{form_end(form)}}
                </div>
            </div>
        </div>
        {# <div class="gdlr-core-pbf-wrapper " style="padding: 75px 0px 75px 0px;">
            <div class="gdlr-core-pbf-background-wrap" style="background-color: #ffffff ;"></div>
            <div class="gdlr-core-pbf-wrapper-content gdlr-core-js " data-gdlr-animation="fadeInUp" data-gdlr-animation-duration="600ms" data-gdlr-animation-offset="0.8">
                <div class="gdlr-core-pbf-wrapper-container clearfix gdlr-core-pbf-wrapper-full-no-space">
                    <div class="gdlr-core-pbf-element">
                        <div class="gdlr-core-social-network-item gdlr-core-item-pdb  gdlr-core-center-align gdlr-core-item-pdlr" style="padding-bottom: 0px;"><a href="mailto:#" target="_blank" class="gdlr-core-social-network-icon" title="email" style="font-size: 20px;color: #232323;"><i class="fa fa-envelope"></i></a><a href="#" target="_blank" class="gdlr-core-social-network-icon" title="facebook" style="font-size: 20px;color: #232323;margin-left: 37px;"><i class="fa fa-facebook"></i></a><a href="#" target="_blank" class="gdlr-core-social-network-icon" title="google-plus" style="font-size: 20px;color: #232323;margin-left: 37px;"><i class="fa fa-google-plus"></i></a><a href="#" target="_blank" class="gdlr-core-social-network-icon" title="linkedin" style="font-size: 20px;color: #232323;margin-left: 37px;"><i class="fa fa-linkedin"></i></a><a href="#" target="_blank" class="gdlr-core-social-network-icon" title="skype" style="font-size: 20px;color: #232323;margin-left: 37px;"><i class="fa fa-skype"></i></a><a href="#" target="_blank" class="gdlr-core-social-network-icon" title="twitter" style="font-size: 20px;color: #232323;margin-left: 37px;"><i class="fa fa-twitter"></i></a></div>
                    </div>
                </div>
            </div>
        </div> #}
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        function formatPrix(prix){
            let text = new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(prix);
            return text;
        }
        function refreshTotal(elmt){
            let totalDom = document.getElementById('total-amount');
            let prix = {{coffret.prix}};
            let qte = elmt.value;
            let total = prix * qte;
            totalDom.innerHTML = formatPrix(total);
        }
    </script>
    {% if payment %}
    <script src="https://js.stripe.com/v3/"></script>
    <script type="text/javascript">
        
        
        $(document).ready(function () {
            var form = document.getElementById('form-payment');
            var errors = document.getElementById('card-errors');
            var cardElement = document.getElementById('card-element');
            
            
            var stripe = Stripe('{{ stripe_public_key }}');
            var elements = stripe.elements();
            var card = elements.create('card');
            
            card.mount('#card-element');
            card.addEventListener('change', function(event) {
                if (event.error) {
                errors.textContent = event.error.message;
                cardElement.classList.add('is-invalid');
                } else {
                errors.textContent = '';
                cardElement.classList.remove('is-invalid');
                }
            });
            
            function submitForm(event){
                event.preventDefault();
                stripe.createToken(card).then(function(result) {
                    if (result.error) {
                        errors.textContent = result.error.message;
                        form.classList.add('has-error');
                    } else {
                        document.getElementById('{{form.token.vars.id}}').setAttribute('value', result.token.id);
                        $('#form-payment').submit();
                    }
                });
            }

            $('#btn-pay').click(submitForm);

        });
    </script>
    
    {% endif %}
{% endblock %}